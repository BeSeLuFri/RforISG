<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Datamanagement: Eurostat Example</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R-Intro ISG</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Introduction</a>
</li>
<li>
  <a href="objectsndata.html">Objects and Data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data Management
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="datamanagement.html">Data Management Introduction</a>
    </li>
    <li>
      <a href="datamanagement_eurostat.html">Eurostat Example</a>
    </li>
    <li>
      <a href="datamanagement_destatis.html">Destatis Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="dataviz.html">Data Viz</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Datamanagement: Eurostat Example</h1>

</div>


<div id="general-and-setup" class="section level1">
<h1><span class="header-section-number">1</span> General and Setup</h1>
<div id="general-coding-information" class="section level2">
<h2><span class="header-section-number">1.1</span> General Coding Information</h2>
<ul>
<li>Retrieve and manage data for the PES project directly via the Eurostat API and the related eurostat R package</li>
<li>Links: <a href="https://github.com/rstudio/cheatsheets/raw/master/eurostat.pdf">eurostat Cheat Sheet</a> and <a href="https://cran.r-project.org/web/packages/eurostat/eurostat.pdf">eurostat Documentation</a></li>
<li>There is a minor bug when working with R_Notebook on the old ISG Windows environments. In case you get the error: “Error creating notebook: pandoc document conversion failed with error 11” just apply <a href="https://github.com/rstudio/rstudio/issues/3661#issuecomment-475705806">this fix</a> from kevinushey (22 Mar 2019).
<ul>
<li>When executing code within R Markdown or a plain script this is no problem at all</li>
</ul></li>
<li>New (obvious) Learning for BF: Never use warning=FALSE in code chunks when working in a R_Notebook –&gt; otherwise you won’t see warnings (surprise, surprise!). I wasted 3h today bc I wasn’t aware of the warnings….</li>
</ul>
</div>
<div id="important-data-management-decisions" class="section level2">
<h2><span class="header-section-number">1.2</span> Important Data Management Decisions</h2>
<ul>
<li>For Belgium regions the following geo identifiers have been used
<ul>
<li><strong>BE1</strong> Région de Bruxelles-Capitale / Brussels Hoofdstedelijk Gewest –&gt; ATTENTION BE10 seems to be identical</li>
<li><strong>BE2</strong> Vlaams Gewest</li>
<li><strong>BE3</strong> Région wallonne</li>
</ul></li>
<li>Youth and working age population
<ul>
<li>Youth defined as “From 15 to 24 years”</li>
<li>Working age populations as “From 15 to 64 years”,</li>
</ul></li>
</ul>
</div>
<div id="different-data-sources-used-than-in-2018" class="section level2">
<h2><span class="header-section-number">1.3</span> Different Data Sources used than in 2018</h2>
<ul>
<li>Unemployment rates for Belgium are not only from lfst_r_lfu3rt anymore but are split into
<ul>
<li>lfst_r_lfur2gac has 15-64</li>
<li>lfst_r_lfu3rt has 15-24</li>
</ul></li>
<li>Employment rates:
<ul>
<li>lfsa_ergaed used instead of lfsa_ergaedn (no citizenship)</li>
</ul></li>
<li>Employment rate by sex and age - Belgium
<ul>
<li>There is only data for the working age population</li>
</ul></li>
<li>Employment growth can be computed for Belgium regions, too
<ul>
<li>because we have the data: lfst_r_lfe2emp</li>
</ul></li>
<li>Nominal GDP per capita
<ul>
<li>We use Gross domestic product at market prices tec00001</li>
</ul></li>
<li>Literacy BE:
<ul>
<li>Different Dataset which includes age group age group 15-65 (which edat_lfse_04 didn’t)</li>
</ul></li>
<li>Excel List Variable No 41 pop_working_age –&gt; no data sheet existent for this variable; plus we already have it in population</li>
<li>Variable No4 seasonal employment not available</li>
<li>In excel list from 2018, we also have a data sheet on “Part-time employment and temporary contracts - annual data [lfsi_pt_a]”
<ul>
<li>However, this is very similiar to “Temporary employees as percentage of the total number of employees, by sex, age and citizenship (%) [lfsa_etpgan]” –&gt; which we also have in the excel list but on sheet 1 (the variable overview)</li>
<li>Only difference is that the former is connected to all types of employment while the latter is only related to the number of employees as numeraire</li>
<li>No important difference, only using the first type of variable</li>
</ul></li>
<li>Minimum Wage: There are two additional variables in the excel list: minwage WSI and minwage (binary)
<ul>
<li>the former is identical to the eurostat minimum wage variable, just in hourly earnings not monthly –&gt; no difference between the two variables</li>
<li>the latter is a binary variable which is time constant –&gt; can’t use it because of the lack of time variance</li>
</ul></li>
<li>Shadow economy Schneider: Please - let’s not use this b****it variable</li>
<li>Strictness of dismissal protection law: No data after 2013 –&gt; excluded accordingly</li>
<li>I have no access to “Tax rate on labour as % of total labour costs (OECD)” –&gt; needs to be purchased retrieved with professional account</li>
<li>Replacement Rate Unemployment benefits: data different from the data in excel file</li>
<li>Benefit duration in months (can’t use it because no time variance)</li>
</ul>
</div>
<div id="the-data-management-structure" class="section level2">
<h2><span class="header-section-number">1.4</span> The data management structure</h2>
<ul>
<li>Each variable/group of related variables has its own header and is being downloaded and manipulated in the same fashion:
<ul>
<li>There are three code chunks: one for a) all countries, b) Belgian regions and c) merging a and b</li>
</ul></li>
<li><ol style="list-style-type: lower-alpha">
<li>and b) themselves have the same order:</li>
</ol>
<ul>
<li>Download data via API with get_eurostat</li>
<li>Label all codes (for easier readability) with label_eurostat</li>
<li>Filter, Select and Spread the data</li>
</ul></li>
<li>The first data group (Employment) has extensive comments do ease the understanding of the code</li>
<li>To retrieve the eurostat codes for datasets check the subchapter Search for Eurostat codes</li>
</ul>
</div>
<div id="load-packages" class="section level2">
<h2><span class="header-section-number">1.5</span> Load packages</h2>
<ul>
<li>If you haven’t done so already, install all the packages below with install.packages(“packagename”)</li>
</ul>
<pre class="r"><code>library(tidyverse) # the state of the art system of packages for data manipulation, exploration and visualization with a a coherent design philosophy
library(eurostat) # the propietary eurostat package for retrieving and manipulating Eurostat data</code></pre>
</div>
<div id="clean-environmentcache" class="section level2">
<h2><span class="header-section-number">1.6</span> Clean Environment/Cache</h2>
<ul>
<li>Eurostat saves all the data we download via the eurostat package in C:and reloads them from there every time you rerun the get_eurostat function
<ul>
<li>This might lead to datasets remaining “unupdated” if we accidentially reload the data from local user and not the API.</li>
<li>therefore, always run clean_eurostat_cache() before new sessions</li>
</ul></li>
</ul>
<pre class="r"><code>rm(list = ls()) # The standard environment cleaner for your R environment
# clean_eurostat_cache() # see bullet points above </code></pre>
</div>
<div id="search-for-eurostat-codes" class="section level2">
<h2><span class="header-section-number">1.7</span> Search for Eurostat codes</h2>
<ul>
<li>Eurostat codes for data tables can be retrieved via search_eurostat</li>
<li>An example (looking for all data containing the name employment in the title):</li>
</ul>
<pre class="r"><code>query &lt;- search_eurostat(&quot;Employment&quot;,
                         type = &quot;all&quot;) # inspect query via View(query)</code></pre>
</div>
</div>
<div id="employment-rate-by-educational-attainment-levels" class="section level1">
<h1><span class="header-section-number">2</span> Employment rate by educational attainment levels</h1>
<div id="countries-lfsa_ergaed-employment-rates-by-sex-age-and-educational-attainment-level" class="section level2">
<h2><span class="header-section-number">2.1</span> Countries: <strong>lfsa_ergaed</strong> Employment rates by sex, age and educational attainment level</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;lfsa_ergaed&quot;, # the relevant id to be downloaded
               time_format = &quot;num&quot;) # retrieve time column as.numeric right away (bc we only have yearly data)
               
data_a &lt;- label_eurostat(data_a,
                           code = c(&quot;geo&quot;,
                                    &quot;isced11&quot;,
                                    &quot;sex&quot;), # we want to keep the &quot;geo&quot; plus relevant identifier items to be able to merge data easily
                           lang = &quot;en&quot;) # English is the default, line included for transparency

data_a &lt;- data_a %&gt;%
  filter(age == &quot;From 15 to 64 years&quot;,
         # filter for appropriate values --&gt; if more variables (for example sex or age) are needed, make changes here!
         isced11_code %in% c(&quot;ED0-2&quot;, &quot;ED3_4&quot;, &quot;ED5-8&quot;)) %&gt;%
  mutate(
    variab = &quot;emp&quot;, # Add variable identifier
    isced11_code = str_replace(isced11_code, &quot;-&quot;, &quot;_&quot;),
    # R doesn&#39;t like &#39;-&#39;(minus) in column names, change that to &#39;_&#39;
    key = paste(variab, isced11_code, sex_code, sep = &quot;_&quot;)
  ) %&gt;% # Merge sex and isced to get different data vars
  select(-c(unit, sex, isced11, sex_code, isced11_code, age, geo)) %&gt;% # remove unnecessary rows (which would be in the way of spread)
  spread(key = key, value = values) %&gt;% # spread out the column whose individual levels are needed as columns
  rename_all(tolower) # all column names in lowercase</code></pre>
</div>
<div id="belgium-lfst_r_lfe2emprtn-employment-rates-by-sex-age-educational-attainment-level-citizenship-and-nuts-2-regions" class="section level2">
<h2><span class="header-section-number">2.2</span> Belgium: <strong>lfst_r_lfe2emprtn</strong> Employment rates by sex, age, educational attainment level, citizenship and NUTS 2 regions</h2>
<pre class="r"><code>data_b &lt;-
  get_eurostat(id = &quot;lfst_r_lfe2emprtn&quot;, # the relevant id to be downloaded
               time_format = &quot;num&quot;) # retrieve time column as.numeric right away (bc we only have yearly data)


data_b &lt;- label_eurostat(
  data_b,
  code = c(&quot;geo&quot;,
           &quot;isced11&quot;,
           &quot;sex&quot;),
  # we want to keep the &quot;geo&quot; and &quot;na_item&quot; column to be able to merge data easily
  lang = &quot;en&quot;,
  # English is the default, line included for transparency
  fix_duplicated = TRUE
)

data_b &lt;- data_b %&gt;%
  filter(
    geo_code %in% c(&quot;BE1&quot;, &quot;BE2&quot;, &quot;BE3&quot;),
    citizen == &quot;Total&quot;, # geo_code and citizen are the only two differences in Belgium compared to Country level for the filter
    age == &quot;From 15 to 64 years&quot;,
    # filter for appropriate values --&gt; if more variables (for example sex or age) are needed, make changes here!
    isced11_code %in% c(&quot;ED0-2&quot;, &quot;ED3_4&quot;, &quot;ED5-8&quot;)
  ) %&gt;%
  mutate(
    variab = &quot;emp&quot;, # Add variable identifier
    isced11_code = str_replace(isced11_code, &quot;-&quot;, &quot;_&quot;),
    # R doesn&#39;t like &#39;-&#39;(minus) in column names, change that to &#39;_&#39;
    key = paste(variab, isced11_code, sex_code, sep = &quot;_&quot;)
  ) %&gt;% # Merge sex and isced to get different data vars
  select(-c(unit, sex, isced11, sex_code, isced11_code, age, geo, citizen)) %&gt;% # remove unnecessary rows (which would be in the way of spread) + Do not forget also to unfilter citizen (extra variable in the Belgium data)
  spread(key = key, value = values) %&gt;% # spread out the column whose individual levels are needed as columns
  rename_all(tolower) # all column names in lowercase</code></pre>
</div>
<div id="rbind-a-and-b" class="section level2">
<h2><span class="header-section-number">2.3</span> Rbind a and b</h2>
<pre class="r"><code>empl_educ &lt;- rbind(data_a, data_b)</code></pre>
</div>
</div>
<div id="unemployment-rates" class="section level1">
<h1><span class="header-section-number">3</span> Unemployment rates</h1>
<div id="unemployment-rates-by-sex-age-and-citizenship-lfsa_urgan" class="section level2">
<h2><span class="header-section-number">3.1</span> Unemployment rates by sex, age and citizenship (%) [lfsa_urgan]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;lfsa_urgan&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;,
                                  &quot;sex&quot;,
                                  &quot;age&quot;))

data_a &lt;- data_a %&gt;%
  filter(age %in% c(&quot;From 15 to 64 years&quot;, &quot;From 15 to 24 years&quot;),
         citizen == &quot;Total&quot;) %&gt;%
  mutate(
    variab = &quot;unemp&quot;,
    variab2 = ifelse(age_code == &quot;Y15-64&quot;, &quot;workagepop&quot;, &quot;youth&quot;),
    key = paste(variab, variab2, sex_code, sep = &quot;_&quot;)
  ) %&gt;%
  select(geo_code, key, time, values) %&gt;%
  spread(key = key, value = values) %&gt;%
  rename_all(tolower)</code></pre>
</div>
<div id="unemployment-rates-by-sex-age-country-of-birth-and-nuts-2-regions-lfst_r_lfu3rt-and-lfst_r_lfur2gac" class="section level2">
<h2><span class="header-section-number">3.2</span> Unemployment rates by sex, age, ((, country of birth)) and NUTS 2 regions (%) [lfst_r_lfu3rt AND lfst_r_lfur2gac]</h2>
<ul>
<li>Somewhat randomly, Unemployment data for Youth and working age population exist but in different datasets:
<ul>
<li>lfst_r_lfur2gac has 15-64</li>
<li>lfst_r_lfu3rt has 15-24</li>
</ul></li>
<li>Accordingly, we load and manipulate both data seperately and merge them</li>
</ul>
<pre class="r"><code># lfst_r_lfur2gac

data_b1 &lt;-
  get_eurostat(id = &quot;lfst_r_lfur2gac&quot;,
               time_format = &quot;num&quot;)

data_b1 &lt;- label_eurostat(data_b1,
                         code = c(&quot;geo&quot;,
                                  &quot;sex&quot;,
                                  &quot;age&quot;),
                         fix_duplicated = TRUE) 

data_b1 &lt;- data_b1 %&gt;%
  filter(
    geo_code %in% c(&quot;BE1&quot;, &quot;BE2&quot;, &quot;BE3&quot;),
    age %in% c(&quot;From 15 to 64 years&quot;, &quot;From 15 to 24 years&quot;),
    c_birth == &quot;Total&quot;
  ) %&gt;% # lfst_r_lfur2gac has 15-64
  mutate(
    variab = &quot;unemp&quot;,
    variab2 = ifelse(age_code == &quot;Y15-64&quot;, &quot;workagepop&quot;, &quot;youth&quot;),
    key = paste(variab, variab2, sex_code, sep = &quot;_&quot;)
  ) %&gt;%
  select(geo_code, key, time, values) %&gt;%
  spread(key = key, value = values) %&gt;%
  rename_all(tolower)


# lfst_r_lfu3rt

data_b2 &lt;-
  get_eurostat(id = &quot;lfst_r_lfu3rt&quot;,
               time_format = &quot;num&quot;)

data_b2 &lt;- label_eurostat(data_b2,
                         code = c(&quot;geo&quot;,
                                  &quot;sex&quot;,
                                  &quot;age&quot;),
                         fix_duplicated = TRUE) 

data_b2 &lt;- data_b2 %&gt;%
  filter(
    geo_code %in% c(&quot;BE1&quot;, &quot;BE2&quot;, &quot;BE3&quot;),
    age %in% c(&quot;From 15 to 64 years&quot;, &quot;From 15 to 24 years&quot;)) %&gt;% # lfst_r_lfur2gac has 15-64
  mutate(
    variab = &quot;unemp&quot;,
    variab2 = ifelse(age_code == &quot;Y15-64&quot;, &quot;workagepop&quot;, &quot;youth&quot;),
    key = paste(variab, variab2, sex_code, sep = &quot;_&quot;)
  ) %&gt;% 
  select(geo_code, key, time, values) %&gt;% 
  spread(key = key, value = values) %&gt;% 
  rename_all(tolower)

# Merge youth and working age pop
data_b &lt;- merge(data_b1, data_b2, by=c(&quot;geo_code&quot;, &quot;time&quot;))</code></pre>
</div>
<div id="rbind-a-and-b-1" class="section level2">
<h2><span class="header-section-number">3.3</span> Rbind a and b</h2>
<pre class="r"><code>unempl &lt;- rbind(data_a, data_b)</code></pre>
</div>
</div>
<div id="employment-rate-by-sex-and-age" class="section level1">
<h1><span class="header-section-number">4</span> Employment rate by sex and age</h1>
<div id="countries-lfsa_ergaed-employment-rates-by-sex-age-and-educational-attainment-level-1" class="section level2">
<h2><span class="header-section-number">4.1</span> Countries: <strong>lfsa_ergaed</strong> Employment rates by sex, age and educational attainment level</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;lfsa_ergaed&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;,
                                  &quot;sex&quot;,
                                  &quot;age&quot;))

data_a &lt;- data_a %&gt;%
  filter(age %in% c(&quot;From 15 to 64 years&quot;, &quot;From 15 to 24 years&quot;),
         isced11 == &quot;All ISCED 2011 levels&quot;) %&gt;%
  mutate(
    variab = &quot;emp&quot;,
    variab2 = ifelse(age_code == &quot;Y15-64&quot;, &quot;workagepop&quot;, &quot;youth&quot;),
    key = paste(variab, variab2, sex_code, sep = &quot;_&quot;)
  ) %&gt;%
  select(geo_code, key, time, values) %&gt;%
  spread(key = key, value = values) %&gt;%
  rename_all(tolower)</code></pre>
</div>
<div id="belgium-lfst_r_lfe2emprtn-employment-rates-by-sex-age-educational-attainment-level-citizenship-and-nuts-2-regions-1" class="section level2">
<h2><span class="header-section-number">4.2</span> Belgium: <strong>lfst_r_lfe2emprtn</strong> Employment rates by sex, age, educational attainment level, citizenship and NUTS 2 regions</h2>
<ul>
<li>Only data on working age population: 15-64</li>
</ul>
<pre class="r"><code>data_b &lt;-
  get_eurostat(id = &quot;lfst_r_lfe2emprtn&quot;,
               time_format = &quot;num&quot;)

data_b &lt;- label_eurostat(data_b,
                         code = c(&quot;geo&quot;,
                                  &quot;sex&quot;,
                                  &quot;age&quot;),
                         fix_duplicated = TRUE) 

data_b &lt;- data_b %&gt;%
  filter(
    geo_code %in% c(&quot;BE1&quot;, &quot;BE2&quot;, &quot;BE3&quot;),
    age %in% c(&quot;From 15 to 64 years&quot;, &quot;From 15 to 24 years&quot;), # only data on working age population available
    citizen == &quot;Total&quot;,
    isced11 == &quot;All ISCED 2011 levels&quot;
  ) %&gt;%
  mutate(
    variab = &quot;emp&quot;,
    variab2 = ifelse(age_code == &quot;Y15-64&quot;, &quot;workagepop&quot;, &quot;youth&quot;),
    key = paste(variab, variab2, sex_code, sep = &quot;_&quot;)
  ) %&gt;%
  select(geo_code, key, time, values) %&gt;%
  spread(key = key, value = values) %&gt;%
  rename_all(tolower) %&gt;%
  mutate(emp_youth_f = NA,
         emp_youth_m = NA,
         emp_youth_t = NA)</code></pre>
</div>
<div id="rbind-a-and-b-2" class="section level2">
<h2><span class="header-section-number">4.3</span> Rbind a and b</h2>
<pre class="r"><code>empl_sex_age &lt;- rbind(data_a, data_b)</code></pre>
</div>
</div>
<div id="transitions-into-unemplyoment-from-employment" class="section level1">
<h1><span class="header-section-number">5</span> Transitions into unemplyoment from employment</h1>
<ul>
<li>Only data on the country level available</li>
</ul>
<div id="labour-transitions-by-employment-status-ilc_lvhl30" class="section level2">
<h2><span class="header-section-number">5.1</span> Labour transitions by employment status [ilc_lvhl30]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;ilc_lvhl30&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;,
                                  &quot;sex&quot;))

data_a &lt;- data_a %&gt;%
  filter(trans1y == &quot;Transition to unemployment&quot;,
         wstatus == &quot;Employed persons&quot;) %&gt;%
  mutate(
    variab = &quot;trans_to_unemp_from_work&quot;,
    key = paste(variab, sex_code, sep = &quot;_&quot;)
  ) %&gt;%
  select(geo_code, key, time, values) %&gt;%
  spread(key = key, value = values) %&gt;%
  rename_all(tolower)</code></pre>
</div>
<div id="rbind-a-and-b-3" class="section level2">
<h2><span class="header-section-number">5.2</span> Rbind a and b</h2>
<ul>
<li>In this case, just rename data_a</li>
</ul>
<pre class="r"><code>transition &lt;- data_a</code></pre>
</div>
</div>
<div id="employment-growth-and-total-employment" class="section level1">
<h1><span class="header-section-number">6</span> Employment Growth and Total Employment</h1>
<ul>
<li>Using the same API code for two variables
<ul>
<li>employment growth</li>
<li>Total Employment</li>
</ul></li>
<li>On employment growth:
<ul>
<li>computed by changes in absolute values</li>
<li>adding a growth function to compute changes</li>
</ul></li>
</ul>
<div id="employment-and-activity-by-sex-and-age---annual-data-lfsi_emp_a" class="section level2">
<h2><span class="header-section-number">6.1</span> Employment and activity by sex and age - annual data [lfsi_emp_a]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;lfsi_emp_a&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;,
                                  &quot;sex&quot;,
                                  &quot;age&quot;))

data_a &lt;- data_a %&gt;%
  filter(
    age %in% c(&quot;From 15 to 64 years&quot;, &quot;From 15 to 24 years&quot;),
    indic_em == &quot;Total employment (resident population concept - LFS)&quot;,
    unit == &quot;Thousand persons&quot;
  ) %&gt;%
  mutate(
    values = values * 1000,
    # Working Population values are in 1000
    variab = &quot;workingpop&quot;,
    variab2 = ifelse(age_code == &quot;Y15-64&quot;, &quot;workagepop&quot;, &quot;youth&quot;),
    key = paste(variab, variab2, sex_code, sep = &quot;_&quot;)
  ) %&gt;%
  select(geo_code, key, time, values) %&gt;%
  spread(key = key, value = values) %&gt;%
  rename_all(tolower)

totempl_a &lt;- data_a %&gt;%
  select(geo_code, time, workingpop_workagepop_f, workingpop_workagepop_m, workingpop_workagepop_t) %&gt;%
  rename(workingpop_m = workingpop_workagepop_m,
         workingpop_f = workingpop_workagepop_f,
         workingpop_t = workingpop_workagepop_t )

# To compute growth a) bring wide data into long data format again, b) group by geo_code and key, c) create column with group lagged values and d) calculate pct changes by combining c) with the value column from a)
data_a &lt;- data_a %&gt;%
  gather(key=key, value = value, 3:8) %&gt;%
  group_by(geo_code, key) %&gt;%
  mutate(lag_value = lag(value),
         pct_change = (value-lag_value)/lag_value) %&gt;%
  select(geo_code, time, key, pct_change) %&gt;%
  spread(key=key, value=pct_change)</code></pre>
</div>
<div id="employment-by-sex-age-and-nuts-2-regions-1-000-lfst_r_lfe2emp" class="section level2">
<h2><span class="header-section-number">6.2</span> Employment by sex, age and NUTS 2 regions (1 000) [lfst_r_lfe2emp]</h2>
<pre class="r"><code>data_b &lt;-
  get_eurostat(id = &quot;lfst_r_lfe2emp&quot;,
               time_format = &quot;num&quot;)

data_b &lt;- label_eurostat(data_b,
                         code = c(&quot;geo&quot;,
                                  &quot;sex&quot;,
                                  &quot;age&quot;),
                         fix_duplicated = TRUE)

data_b &lt;- data_b %&gt;%
  filter(
    geo_code %in% c(&quot;BE1&quot;, &quot;BE2&quot;, &quot;BE3&quot;),
    age %in% c(&quot;From 15 to 64 years&quot;, &quot;From 15 to 24 years&quot;)
  ) %&gt;%
  mutate(
    values = values * 1000,
    # Working Population values are in 1000
    variab = &quot;workingpop&quot;,
    variab2 = ifelse(age_code == &quot;Y15-64&quot;, &quot;workagepop&quot;, &quot;youth&quot;),
    key = paste(variab, variab2, sex_code, sep = &quot;_&quot;)
  ) %&gt;%
  select(geo_code, key, time, values) %&gt;%
  spread(key = key, value = values) %&gt;%
  rename_all(tolower)

totempl_b &lt;- data_b %&gt;%
  select(geo_code, time, workingpop_workagepop_f, workingpop_workagepop_m, workingpop_workagepop_t) %&gt;%
  rename(workingpop_m = workingpop_workagepop_m,
         workingpop_f = workingpop_workagepop_f,
         workingpop_t = workingpop_workagepop_t )

# To compute growth a) bring wide data into long data format again, b) group by geo_code and key, c) create column with group lagged values and d) calculate pct changes by combining c) with the value column from a)
data_b &lt;- data_b %&gt;%
  gather(key=key, value = value, 3:8) %&gt;%
  group_by(geo_code, key) %&gt;%
  mutate(lag_value = lag(value),
         pct_change = (value-lag_value)/lag_value) %&gt;%
  select(geo_code, time, key, pct_change) %&gt;%
  spread(key=key, value=pct_change)</code></pre>
</div>
<div id="rbind-a-and-b-4" class="section level2">
<h2><span class="header-section-number">6.3</span> Rbind a and b</h2>
<pre class="r"><code>empl_growth &lt;- rbind(data_a, data_b)
totemp &lt;- rbind(totempl_a, totempl_b)</code></pre>
</div>
</div>
<div id="gdp-growth" class="section level1">
<h1><span class="header-section-number">7</span> GDP growth</h1>
<div id="real-gdp-growth-rate---volume-tec00115" class="section level2">
<h2><span class="header-section-number">7.1</span> Real GDP growth rate - volume tec00115</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;tec00115&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;))

data_a &lt;- data_a %&gt;%
  mutate(gdp_gr = values) %&gt;%
  select(geo_code, time, gdp_gr) </code></pre>
</div>
<div id="real-growth-rate-of-regional-gross-value-added-gva-at-basic-prices-by-nuts-2-regions---percentage-change-on-previous-year-nama_10r_2gvagr" class="section level2">
<h2><span class="header-section-number">7.2</span> Real growth rate of regional gross value added (GVA) at basic prices by NUTS 2 regions - percentage change on previous year [nama_10r_2gvagr]</h2>
<pre class="r"><code>data_b &lt;-
  get_eurostat(id = &quot;nama_10r_2gvagr&quot;,
               time_format = &quot;num&quot;)

data_b &lt;- label_eurostat(data_b,
                         code = c(&quot;geo&quot;), 
                         fix_duplicated = TRUE)

data_b &lt;- data_b %&gt;%
  filter(geo_code %in% c(&quot;BE1&quot;, &quot;BE2&quot;, &quot;BE3&quot;)) %&gt;%
  mutate(gdp_gr = values) %&gt;%
  select(geo_code, time, gdp_gr)</code></pre>
</div>
<div id="rbind-a-and-b-5" class="section level2">
<h2><span class="header-section-number">7.3</span> Rbind a and b</h2>
<pre class="r"><code>gdp_gr &lt;- rbind(data_a, data_b)</code></pre>
</div>
</div>
<div id="nominal-gdp-per-capita" class="section level1">
<h1><span class="header-section-number">8</span> Nominal GDP per capita</h1>
<div id="gross-domestic-product-at-market-prices-tec00001" class="section level2">
<h2><span class="header-section-number">8.1</span> Gross domestic product at market prices tec00001</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;tec00001&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;))

data_a &lt;- data_a %&gt;%
  filter(unit==&quot;Current prices, euro per capita&quot;) %&gt;%
  mutate(gdp_pc = values) %&gt;%
  select(geo_code, time, gdp_pc) </code></pre>
</div>
<div id="gross-domestic-product-gdp-at-current-market-prices-by-nuts-2-regions-nama_10r_2gdp" class="section level2">
<h2><span class="header-section-number">8.2</span> Gross domestic product (GDP) at current market prices by NUTS 2 regions [nama_10r_2gdp]</h2>
<pre class="r"><code>data_b &lt;-
  get_eurostat(id = &quot;nama_10r_2gdp&quot;,
               time_format = &quot;num&quot;)

data_b &lt;- label_eurostat(data_b,
                         code = c(&quot;geo&quot;), 
                         fix_duplicated = TRUE)

data_b &lt;- data_b %&gt;%
  filter(unit == &quot;Euro per inhabitant&quot;,
         geo_code %in% c(&quot;BE1&quot;, &quot;BE2&quot;, &quot;BE3&quot;)) %&gt;%
  mutate(gdp_pc = values) %&gt;%
  select(geo_code, time, gdp_pc)</code></pre>
</div>
<div id="rbind-a-and-b-6" class="section level2">
<h2><span class="header-section-number">8.3</span> Rbind a and b</h2>
<pre class="r"><code>gdp_pc &lt;- rbind(data_a, data_b)</code></pre>
</div>
</div>
<div id="investment-rate" class="section level1">
<h1><span class="header-section-number">9</span> Investment Rate</h1>
<ul>
<li>Only Data for country level</li>
<li>getting data for the variables:
<ul>
<li>Investment rate (investment/value added at factors cost) - percentage</li>
<li>Investment per person employed - milliers d’euros</li>
</ul></li>
</ul>
<div id="annual-enterprise-statistics-for-special-aggregates-of-activities-nace-rev.-2-sbs_na_sca_r2" class="section level2">
<h2><span class="header-section-number">9.1</span> Annual enterprise statistics for special aggregates of activities (NACE Rev. 2) [sbs_na_sca_r2]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;sbs_na_sca_r2&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;),
                         fix_duplicated = TRUE)

data_a &lt;- data_a %&gt;%
  filter(
    nace_r2 ==
      &quot;Total business economy; repair of computers, personal and household goods; except financial and insurance activities&quot;,
    indic_sb %in% c(
      &quot;Investment rate (investment/value added at factors cost) - percentage&quot;,
      &quot;Investment per person employed - milliers d&#39;euros&quot;
    )
  ) %&gt;%
  mutate(
    key = ifelse(
      indic_sb == &quot;Investment per person employed - milliers d&#39;euros&quot;,
      &quot;inv_per_empl&quot;,
      &quot;inv_total&quot;
    )
  ) %&gt;%
  select(-c(nace_r2, indic_sb, geo)) %&gt;%
  spread(key = key, value = values) %&gt;%
  select(geo_code, time, inv_per_empl, inv_total) </code></pre>
</div>
<div id="rbind-a-and-b-7" class="section level2">
<h2><span class="header-section-number">9.2</span> Rbind a and b</h2>
<pre class="r"><code>inv &lt;- data_a</code></pre>
</div>
</div>
<div id="minimum-wage" class="section level1">
<h1><span class="header-section-number">10</span> Minimum Wage</h1>
<div id="monthly-minimum-wages---bi-annual-data-earn_mw_cur" class="section level2">
<h2><span class="header-section-number">10.1</span> Monthly minimum wages - bi-annual data earn_mw_cur</h2>
<ul>
<li>We take the Minimum wage at the beginning of the year –&gt; bi-annual data makes no sense for our case</li>
<li>We use the mimimum wage in Purchasing Power Standards</li>
<li>Belgian minimum wage is binding for all regions –&gt; accordingly we add the minimum wage for the Belgian regions</li>
</ul>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;earn_mw_cur&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;))

data_a &lt;- data_a %&gt;%
  filter(currency == &quot;Purchasing Power Standard&quot;,
         time %in% c(1999:2019)) %&gt;%
  mutate(min_wage = values) %&gt;%
  select(geo_code, time, min_wage)

data_b &lt;-
  data.frame(geo_code = rep(c(&quot;BE1&quot;, &quot;BE2&quot;, &quot;BE3&quot;), each = (max(data_a$time) -
                                                              min(data_a$time) +
                                                              1)),
             time = rep(min(data_a$time):max(data_a$time), 3))

data_b &lt;-
  merge(
    x = data_b,
    y = data_a[data_a$geo_code == &quot;BE&quot;, c(&quot;time&quot;, &quot;min_wage&quot;)],
    by = c(&quot;time&quot;),
    all.x = TRUE
  )</code></pre>
</div>
<div id="rbind-a-and-b-8" class="section level2">
<h2><span class="header-section-number">10.2</span> Rbind a and b</h2>
<pre class="r"><code>min_wage &lt;- rbind(data_a, data_b)</code></pre>
</div>
</div>
<div id="number-of-small-and-medium-sized-enterprises" class="section level1">
<h1><span class="header-section-number">11</span> Number of small and medium-sized enterprises</h1>
<ul>
<li>Data only available for countries</li>
</ul>
<div id="annual-enterprise-statistics-by-size-class-for-special-aggregates-of-activities-nace-rev.-2-sbs_sc_sca_r2" class="section level2">
<h2><span class="header-section-number">11.1</span> Annual enterprise statistics by size class for special aggregates of activities (NACE Rev. 2) [sbs_sc_sca_r2]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;sbs_sc_sca_r2&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;),
                         fix_duplicated = TRUE)


data_a &lt;- data_a %&gt;%
  filter(
    nace_r2 ==
      &quot;Total business economy; repair of computers, personal and household goods; except financial and insurance activities&quot;,
    indic_sb %in% c(&quot;Enterprises - number&quot;)
  ) %&gt;%
  mutate(
    size_emp = dplyr::recode(
      size_emp,
      &quot;From 0 to 9 persons employed&quot; = &quot;empsize_verysmall&quot;,
      &quot;From 10 to 19 persons employed&quot; = &quot;empsize_small&quot;,
      &quot;From 20 to 49 persons employed&quot; = &quot;empsize_medium&quot;,
      &quot;From 50 to 249 persons employed&quot; = &quot;empsize_big&quot;,
      &quot;250 persons employed or more&quot; = &quot;empsize_verybig&quot;,
      &quot;Total&quot; = &quot;empsize_total&quot;
    )
  ) %&gt;%
  select(-c(nace_r2, indic_sb, geo)) %&gt;%
  spread(key = size_emp, value = values)</code></pre>
</div>
<div id="rbind-a-and-b-9" class="section level2">
<h2><span class="header-section-number">11.2</span> Rbind a and b</h2>
<pre class="r"><code>empsize &lt;- data_a</code></pre>
</div>
</div>
<div id="school-dropouts" class="section level1">
<h1><span class="header-section-number">12</span> School Dropouts</h1>
<div id="early-leavers-from-education-and-training-by-sex-and-labour-status-edat_lfse_14" class="section level2">
<h2><span class="header-section-number">12.1</span> Early leavers from education and training by sex and labour status [edat_lfse_14]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;edat_lfse_14&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;, &quot;sex&quot;))

data_a &lt;- data_a %&gt;%
  filter(
    wstatus ==&quot;Population&quot;
  ) %&gt;%
  mutate(
    key = paste(&quot;dropout&quot;, sex_code ,sep=&quot;_&quot;)
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values) </code></pre>
</div>
<div id="early-leavers-from-education-and-training-by-sex-and-nuts-2-regions-edat_lfse_16" class="section level2">
<h2><span class="header-section-number">12.2</span> Early leavers from education and training by sex and NUTS 2 regions [edat_lfse_16]</h2>
<pre class="r"><code>data_b &lt;-
  get_eurostat(id = &quot;edat_lfse_16&quot;,
               time_format = &quot;num&quot;)

data_b &lt;- label_eurostat(data_b,
                         code = c(&quot;geo&quot;,&quot;sex&quot;), 
                         fix_duplicated = TRUE)

data_b &lt;- data_b %&gt;%
  filter(geo_code %in% c(&quot;BE1&quot;, &quot;BE2&quot;, &quot;BE3&quot;)) %&gt;%
 mutate(
    key = paste(&quot;dropout&quot;, sex_code ,sep=&quot;_&quot;)
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values) </code></pre>
</div>
<div id="rbind-a-and-b-10" class="section level2">
<h2><span class="header-section-number">12.3</span> Rbind a and b</h2>
<pre class="r"><code>dropout &lt;- rbind(data_a, data_b)</code></pre>
</div>
</div>
<div id="literacy" class="section level1">
<h1><span class="header-section-number">13</span> Literacy</h1>
<ul>
<li>Not really literacy –&gt; rather low education level</li>
</ul>
<div id="population-by-educational-attainment-level-sex-and-age-edat_lfs_9903" class="section level2">
<h2><span class="header-section-number">13.1</span> Population by educational attainment level, sex and age (%) [edat_lfs_9903]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;edat_lfs_9903&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;, &quot;sex&quot;))

data_a &lt;- data_a %&gt;%
  filter(
    isced11 ==&quot;Less than primary, primary and lower secondary education (levels 0-2)&quot;,
    age == &quot;From 15 to 64 years&quot;
  ) %&gt;%
  mutate(
    key = paste(&quot;literacy&quot;, sex_code ,sep=&quot;_&quot;)
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values) </code></pre>
</div>
<div id="population-by-educational-attainment-level-sex-age-country-of-birth-and-nuts-2-regions-edat_lfs_9917" class="section level2">
<h2><span class="header-section-number">13.2</span> Population by educational attainment level, sex, age, country of birth and NUTS 2 regions (%) [edat_lfs_9917]</h2>
<pre class="r"><code>data_b &lt;-
  get_eurostat(id = &quot;edat_lfs_9917&quot;,
               time_format = &quot;num&quot;)

data_b &lt;- label_eurostat(data_b,
                         code = c(&quot;geo&quot;,&quot;sex&quot;), 
                         fix_duplicated = TRUE)

data_b &lt;- data_b %&gt;%
  filter(geo_code %in% c(&quot;BE1&quot;, &quot;BE2&quot;, &quot;BE3&quot;),
         isced11 == &quot;Less than primary, primary and lower secondary education (levels 0-2)&quot;,
         age == &quot;From 15 to 64 years&quot;,
         c_birth == &quot;Total&quot;) %&gt;%
 mutate(
    key = paste(&quot;literacy&quot;, sex_code ,sep=&quot;_&quot;)
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values) </code></pre>
</div>
<div id="rbind-a-and-b-11" class="section level2">
<h2><span class="header-section-number">13.3</span> Rbind a and b</h2>
<pre class="r"><code>literacy &lt;- rbind(data_a, data_b)</code></pre>
</div>
</div>
<div id="childcare" class="section level1">
<h1><span class="header-section-number">14</span> Childcare</h1>
<ul>
<li>Not really literacy –&gt; rather low education level</li>
</ul>
<div id="formal-childcare-by-age-group-and-duration---over-the-population-of-each-age-group---eu-silc-survey-ilc_caindformal" class="section level2">
<h2><span class="header-section-number">14.1</span> Formal childcare by age group and duration - % over the population of each age group - EU-SILC survey [ilc_caindformal]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;ilc_caindformal&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;))

data_a &lt;- data_a %&gt;%
  filter(duration != &quot;Zero hours&quot;) %&gt;%
  mutate(
    age = dplyr::recode(
      age,
      &quot;From minimum compulsory school age to 12 years&quot; = &quot;schoolageto12&quot;,
      &quot;From 3 years to minimum compulsory school age&quot; = &quot;threetoschoolage&quot;,
      &quot;From 3 years to minimum compulsory school age&quot; = &quot;lessthan3&quot;
    ),
    duration = dplyr::recode(
      duration,
      &quot;From 1 to 29 hours&quot; = &quot;from1to29h&quot;,
      &quot;30 hours or over&quot; = &quot;over30h&quot;
    ),
    key = paste(&quot;childcare&quot;, age, duration, sep = &quot;_&quot;)
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values) </code></pre>
</div>
<div id="rbind-a-and-b-12" class="section level2">
<h2><span class="header-section-number">14.2</span> Rbind a and b</h2>
<pre class="r"><code>childcare &lt;- data_a</code></pre>
</div>
</div>
<div id="labour-productivity" class="section level1">
<h1><span class="header-section-number">15</span> Labour productivity</h1>
<div id="labour-productivity-and-unit-labour-costs-nama_10_lp_ulc" class="section level2">
<h2><span class="header-section-number">15.1</span> Labour productivity and unit labour costs [nama_10_lp_ulc]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;nama_10_lp_ulc&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;))

data_a &lt;- data_a %&gt;%
  filter(
    unit == &quot;Percentage change on previous period&quot;,
    na_item == &quot;Real labour productivity per person&quot;
  ) %&gt;%
  mutate(
    key = paste0(&quot;gr_productiv&quot;)
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values) </code></pre>
</div>
<div id="rbind-a-and-b-13" class="section level2">
<h2><span class="header-section-number">15.2</span> Rbind a and b</h2>
<pre class="r"><code>gr_productiv &lt;- data_a</code></pre>
</div>
</div>
<div id="pop" class="section level1">
<h1><span class="header-section-number">16</span> Pop</h1>
<div id="population-on-1-january-by-broad-age-group-and-sex-demo_pjanbroad" class="section level2">
<h2><span class="header-section-number">16.1</span> Population on 1 January by broad age group and sex [demo_pjanbroad]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;demo_pjanbroad&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;, &quot;sex&quot;))

data_a &lt;- data_a %&gt;%
  filter(
    age != &quot;Unknown&quot;,
    time &gt;= 2002,
  ) %&gt;%
  mutate(
    age = dplyr::recode(
      age,
      &quot;Total&quot; = &quot;total&quot;,
      &quot;From 15 to 64 years&quot; = &quot;pop1564&quot;,
      &quot;65 years or over&quot; = &quot;pop65&quot;,
      &quot;Less than 15 years&quot; = &quot;pop15&quot;),
    key = paste(&quot;population&quot;, age, sex_code, sep=&quot;_&quot;)
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values)  </code></pre>
</div>
<div id="population-on-1-january-by-broad-age-group-sex-and-nuts-3-region-demo_r_pjanaggr3" class="section level2">
<h2><span class="header-section-number">16.2</span> Population on 1 January by broad age group, sex and NUTS 3 region [demo_r_pjanaggr3]</h2>
<pre class="r"><code>data_b &lt;-
  get_eurostat(id = &quot;demo_r_pjanaggr3&quot;,
               time_format = &quot;num&quot;)

data_b &lt;- label_eurostat(data_b,
                         code = c(&quot;geo&quot;,&quot;sex&quot;), 
                         fix_duplicated = TRUE)

data_b &lt;- data_b %&gt;%
  filter(
    geo_code %in% c(&quot;BE1&quot;, &quot;BE2&quot;, &quot;BE3&quot;),
    age != &quot;Unknown&quot;,
    time &gt;= 2002,
  ) %&gt;%
  mutate(
    age = dplyr::recode(
      age,
      &quot;Total&quot; = &quot;total&quot;,
      &quot;From 15 to 64 years&quot; = &quot;pop1564&quot;,
      &quot;65 years or over&quot; = &quot;pop65&quot;,
      &quot;Less than 15 years&quot; = &quot;pop15&quot;),
    key = paste(&quot;population&quot;, age, sex_code, sep=&quot;_&quot;)
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values) </code></pre>
</div>
<div id="rbind-a-and-b-14" class="section level2">
<h2><span class="header-section-number">16.3</span> Rbind a and b</h2>
<pre class="r"><code>popul &lt;- rbind(data_a, data_b)</code></pre>
</div>
</div>
<div id="dependency-ratios" class="section level1">
<h1><span class="header-section-number">17</span> Dependency Ratios</h1>
<pre class="r"><code>depratio &lt;- popul %&gt;%
  mutate(tot_depratio_F = (population_pop15_F+population_pop65_F)/population_pop1564_F,
         tot_depratio_M = (population_pop15_M+population_pop65_M)/population_pop1564_M,
         tot_depratio_T = (population_pop15_T+population_pop65_T)/population_pop1564_T,
         
         old_depratio_F = population_pop65_F/population_pop1564_F,
         old_depratio_M = population_pop65_M/population_pop1564_M,
         old_depratio_T = population_pop65_T/population_pop1564_T,
         
         young_depratio_F = population_pop15_F/population_pop1564_F,
         young_depratio_M = population_pop15_M/population_pop1564_M,
         young_depratio_T = population_pop15_T/population_pop1564_T
         ) %&gt;%
  select(geo_code, time, 15:23) </code></pre>
</div>
<div id="immigration" class="section level1">
<h1><span class="header-section-number">18</span> Immigration</h1>
<div id="immigration-by-age-group-sex-and-citizenship-migr_imm1ctz" class="section level2">
<h2><span class="header-section-number">18.1</span> Immigration by age group, sex and citizenship [migr_imm1ctz]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;migr_imm1ctz&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;, &quot;sex&quot;))

data_a &lt;- data_a %&gt;%
  filter(
    citizen == &quot;Total&quot;,
    agedef == &quot;Age in completed years&quot;,
    age == &quot;Total&quot;, 
  ) %&gt;%
  mutate(
    key = paste(&quot;immigration&quot;, sex_code, sep=&quot;_&quot;),
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values)  </code></pre>
</div>
<div id="rbind-a-and-b-15" class="section level2">
<h2><span class="header-section-number">18.2</span> Rbind a and b</h2>
<pre class="r"><code>immigr &lt;- data_a</code></pre>
</div>
</div>
<div id="emmigration" class="section level1">
<h1><span class="header-section-number">19</span> Emmigration</h1>
<div id="emigration-by-age-group-sex-and-citizenship-migr_emi1ctz" class="section level2">
<h2><span class="header-section-number">19.1</span> Emigration by age group, sex and citizenship [migr_emi1ctz]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;migr_emi1ctz&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;, &quot;sex&quot;))

data_a &lt;- data_a %&gt;%
  filter(
    citizen == &quot;Total&quot;,
    agedef == &quot;Age in completed years&quot;,
    age == &quot;Total&quot;, 
  ) %&gt;%
  mutate(
    key = paste(&quot;emmigration&quot;, sex_code, sep=&quot;_&quot;),
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values)  </code></pre>
</div>
<div id="rbind-a-and-b-16" class="section level2">
<h2><span class="header-section-number">19.2</span> Rbind a and b</h2>
<pre class="r"><code>emmigr &lt;- data_a</code></pre>
</div>
</div>
<div id="temporary-employees" class="section level1">
<h1><span class="header-section-number">20</span> Temporary Employees</h1>
<div id="temporary-employees-as-percentage-of-the-total-number-of-employees-by-sex-age-and-citizenship-lfsa_etpgan" class="section level2">
<h2><span class="header-section-number">20.1</span> Temporary employees as percentage of the total number of employees, by sex, age and citizenship (%) [lfsa_etpgan]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;lfsa_etpgan&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;, &quot;sex&quot;))

data_a &lt;- data_a %&gt;%
  filter(
    citizen == &quot;Total&quot;,
    age == &quot;From 15 to 64 years&quot;, 
  ) %&gt;%
  mutate(
    key = paste(&quot;tempemp&quot;, sex_code, sep=&quot;_&quot;),
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values)  </code></pre>
</div>
<div id="rbind-a-and-b-17" class="section level2">
<h2><span class="header-section-number">20.2</span> Rbind a and b</h2>
<pre class="r"><code>tempemp &lt;- data_a</code></pre>
</div>
</div>
<div id="share-in-finding-job-with-contribution-of-pes" class="section level1">
<h1><span class="header-section-number">21</span> Share in finding job with contribution of PES</h1>
<div id="methods-used-for-seeking-work--percentage-of-unemployed-who-declared-having-used-a-given-method-by-sex-lfsa_ugmsw" class="section level2">
<h2><span class="header-section-number">21.1</span> Methods used for seeking work- Percentage of unemployed who declared having used a given method, by sex (%) [lfsa_ugmsw]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;lfsa_ugmsw&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;, &quot;sex&quot;))

data_a &lt;- data_a %&gt;%
  filter(
    swmethod == &quot;Contact public employment office&quot;,
  ) %&gt;%
  mutate(
    key = paste(&quot;jobsearchpes&quot;, sex_code, sep=&quot;_&quot;),
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values)  </code></pre>
</div>
<div id="rbind-a-and-b-18" class="section level2">
<h2><span class="header-section-number">21.2</span> Rbind a and b</h2>
<pre class="r"><code>jobsrch &lt;- data_a</code></pre>
</div>
</div>
<div id="activity-rate-of-females-and-foreigners" class="section level1">
<h1><span class="header-section-number">22</span> Activity rate of females and foreigners</h1>
<ul>
<li>Two variable groups retrieved and merged here: Gender and Citizenship</li>
<li>we give values both for male and female as well as for total</li>
</ul>
<div id="activity-rates-by-sex-age-and-citizenship-lfsa_argan" class="section level2">
<h2><span class="header-section-number">22.1</span> Activity rates by sex, age and citizenship (%) [lfsa_argan]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;lfsa_argan&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;, &quot;sex&quot;))

data_a &lt;- data_a %&gt;%
  filter(
    citizen %in% c(&quot;Total&quot;, &quot;Foreign country&quot;, &quot;Reporting country&quot;),
    age == &quot;From 15 to 64 years&quot;, 
  ) %&gt;%
  mutate(
    citizen = dplyr::recode(citizen,
                     &quot;Total&quot;= &quot;total&quot;, 
                     &quot;Foreign country&quot; = &quot;foreign&quot;, 
                     &quot;Reporting country&quot; = &quot;home&quot;),
    key = paste(&quot;activityrate&quot;, citizen, sex_code, sep=&quot;_&quot;),
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values)  </code></pre>
</div>
<div id="activity-rates-by-sex-age-educational-attainment-level-citizenship-and-nuts-2-regions-lfst_r_lfp2actrtn" class="section level2">
<h2><span class="header-section-number">22.2</span> Activity rates by sex, age, educational attainment level, citizenship and NUTS 2 regions [lfst_r_lfp2actrtn]</h2>
<pre class="r"><code>data_b &lt;-
  get_eurostat(id = &quot;lfst_r_lfp2actrtn&quot;,
               time_format = &quot;num&quot;)

data_b &lt;- label_eurostat(data_b,
                         code = c(&quot;geo&quot;, &quot;sex&quot;),
                         fix_duplicated = TRUE)

data_b &lt;- data_b %&gt;%
  filter(
    geo_code %in% c(&quot;BE1&quot;, &quot;BE2&quot;, &quot;BE3&quot;),
    citizen %in% c(&quot;Total&quot;, &quot;Foreign country&quot;, &quot;Reporting country&quot;),
    age == &quot;From 15 to 64 years&quot;, 
    isced11 == &quot;All ISCED 2011 levels&quot;,
  ) %&gt;%
  mutate(
    citizen = dplyr::recode(citizen,
                     &quot;Total&quot;= &quot;total&quot;, 
                     &quot;Foreign country&quot; = &quot;foreign&quot;, 
                     &quot;Reporting country&quot; = &quot;home&quot;),
    key = paste(&quot;activityrate&quot;, citizen, sex_code, sep=&quot;_&quot;),
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values)  </code></pre>
</div>
<div id="rbind-a-and-b-19" class="section level2">
<h2><span class="header-section-number">22.3</span> Rbind a and b</h2>
<pre class="r"><code>activtyrate &lt;- rbind(data_a, data_b)</code></pre>
</div>
</div>
<div id="part-time" class="section level1">
<h1><span class="header-section-number">23</span> Part time</h1>
<div id="part-time-employment-and-temporary-contracts---annual-data-lfsi_pt_a" class="section level2">
<h2><span class="header-section-number">23.1</span> Part-time employment and temporary contracts - annual data [lfsi_pt_a]</h2>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;lfsi_pt_a&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;, &quot;sex&quot;))

data_a &lt;- data_a %&gt;%
  filter(
    worktime == &quot;Part-time&quot;,
    unit == &quot;Percentage of total employment&quot;,
    age == &quot;From 15 to 64 years&quot;, 
  ) %&gt;%
  mutate(
    key = paste(&quot;parttime&quot;, sex_code, sep=&quot;_&quot;),
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values)  </code></pre>
</div>
<div id="employment-by-full-timepart-time-sex-and-nuts-2-regions-1-000-lfst_r_lfe2eftpt" class="section level2">
<h2><span class="header-section-number">23.2</span> Employment by full-time/part-time, sex and NUTS 2 regions (1 000) [lfst_r_lfe2eftpt]</h2>
<pre class="r"><code>data_b &lt;-
  get_eurostat(id = &quot;lfst_r_lfe2eftpt&quot;,
               time_format = &quot;num&quot;)

data_b &lt;- label_eurostat(data_b,
                         code = c(&quot;geo&quot;, &quot;sex&quot;),
                         fix_duplicated = TRUE)

data_b &lt;- data_b %&gt;%
  filter(
    geo_code %in% c(&quot;BE1&quot;, &quot;BE2&quot;, &quot;BE3&quot;),
    worktime %in% c(&quot;Total&quot;, &quot;Part-time&quot;)
  ) %&gt;%
  mutate(
    key = paste(worktime, sex_code, sep=&quot;_&quot;),
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values) %&gt;%
  mutate(parttime_F = `Part-time_F` / Total_F,
         parttime_M = `Part-time_M` / Total_M,
         parttime_T = `Part-time_T` / Total_T) %&gt;%
  select(geo_code, time, parttime_F, parttime_M, parttime_T)</code></pre>
</div>
<div id="rbind-a-and-b-20" class="section level2">
<h2><span class="header-section-number">23.3</span> Rbind a and b</h2>
<pre class="r"><code>parttime &lt;- rbind(data_a, data_b)</code></pre>
</div>
</div>
<div id="enterprise-death-rates" class="section level1">
<h1><span class="header-section-number">24</span> Enterprise Death Rates</h1>
<ul>
<li>Business demography by legal form (from 2004 onwards, NACE Rev. 2) [bd_9ac_l_form_r2]</li>
<li>Only available for countries</li>
</ul>
<pre class="r"><code>data_a &lt;-
  get_eurostat(id = &quot;bd_9ac_l_form_r2&quot;,
               time_format = &quot;num&quot;)

data_a &lt;- label_eurostat(data_a,
                         code = c(&quot;geo&quot;),
                         fix_duplicated = TRUE)

data_a &lt;- data_a %&gt;%
  filter(
    indic_sb %in% c(&quot;Deaths of enterprises in t - number&quot;, &quot;Death rate: number of enterprise deaths in the reference period (t) divided by the number of enterprises active in t - percentage&quot;), 
    leg_form == &quot;Total&quot;,
    nace_r2 == &quot;Industry, construction and services except insurance activities of holding companies&quot;, 
  ) %&gt;%
  mutate(
    indic_sb = dplyr::recode(indic_sb,
                      &quot;Deaths of enterprises in t - number&quot; = &quot;enterprisedeath_tot&quot;, 
                      &quot;Death rate: number of enterprise deaths in the reference period (t) divided by the number of enterprises active in t - percentage&quot; = &quot;enterprisedeath_perc&quot;),
    key = indic_sb,
  ) %&gt;%
  select(geo_code, time, key, values) %&gt;%
  spread(key = key, value = values) </code></pre>
<div id="rbind-a-and-b-21" class="section level2">
<h2><span class="header-section-number">24.1</span> Rbind a and b</h2>
<pre class="r"><code>death &lt;- data_a</code></pre>
</div>
</div>
<div id="replacement-rate-of-last-earnings-before-unemployment" class="section level1">
<h1><span class="header-section-number">25</span> Replacement Rate of last earnings before unemployment</h1>
<ul>
<li>From OECD</li>
<li><a href="https://stats.oecd.org/Index.aspx?DataSetCode=NRR#_ga=2.115968198.1529179679.1559572370-478591159.1556266530" class="uri">https://stats.oecd.org/Index.aspx?DataSetCode=NRR#_ga=2.115968198.1529179679.1559572370-478591159.1556266530</a></li>
<li>Which time –&gt; data different from the data in excel file ToDo <span class="citation">@HV</span></li>
</ul>
<pre class="r"><code># reprate &lt;- read_csv(&quot;2019/orig/test/Replacement Rate last earnings.csv&quot;)</code></pre>
</div>
<div id="left-over-for-hans" class="section level1">
<h1><span class="header-section-number">26</span> Left over for Hans</h1>
<ul>
<li>Share of self-employed (Var no 53)</li>
<li>Duration of working life (Var no 54)</li>
</ul>
<p>+++++++++++++++++++++</p>
</div>
<div id="merge-all-df-together-and-save-as-csv" class="section level1">
<h1><span class="header-section-number">27</span> Merge all df together and save as csv</h1>
<pre class="r"><code>df_final &lt;-
  Reduce(
    function(x, y)
      full_join(x, y, by = c(&quot;geo_code&quot;, &quot;time&quot;)),
    list(empl_educ, unempl, empl_sex_age, transition, empl_growth, totemp, gdp_gr, gdp_pc, inv, min_wage, empsize, dropout,  
         literacy, childcare, gr_productiv, popul, depratio, immigr, emmigr, tempemp, jobsrch, activtyrate, parttime, death)
  )

df_final &lt;- df_final %&gt;%
  group_by(geo_code, time) %&gt;%
  rename_all(tolower)

# write_excel_csv2(df_final, &quot;data_uptodate.csv&quot;)</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
